<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>全球股市指數地圖</title>
    <meta name="description" content="全球股市指數即時數據地圖，包含美國、德國、英國、法國、日本、韓國、台灣、香港、中國等主要市場指數">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90' style='filter: grayscale(100%);'>🌐</text></svg>">
    <link rel="stylesheet" href="styles.css">
    
    <!-- Google Material Icons -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    
    <!-- amCharts 5 Libraries -->
    <script src="https://cdn.amcharts.com/lib/5/index.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/map.js"></script>
    <script src="https://cdn.amcharts.com/lib/5/geodata/worldLow.js"></script>
</head>
<body>
    <!-- Logo -->
    <div class="logo">World Stock</div>

    <!-- Floating Filter Tabs (Google Maps Style) -->
    <div class="filter-tabs">
        <button class="filter-tab active" data-mode="stock" onclick="switchMode('stock')">
            <span class="material-symbols-outlined">show_chart</span>
            股市指數
        </button>
        <button class="filter-tab" data-mode="etf" onclick="switchMode('etf')">
            <span class="material-symbols-outlined">public</span>
            國家 ETF
        </button>
    </div>

    <!-- World Map Container -->
    <div class="map-container">
        <!-- Map Background -->
        <div id="chartdiv" class="world-map"></div>

        <!-- Stock Index Cards -->
        
        <!-- 美國指數 -->
        <div class="index-card" style="left: 23.7%; top: 32.6%;">
            <div class="card-header">
                <img src="https://flagcdn.com/w40/us.png" alt="US Flag" class="flag">
                <div class="date-status">
                    <div class="date">-</div>
                    <div class="status closed">載入中...</div>
                </div>
            </div>
            <div class="index-name">道瓊指數</div>
            <div class="index-value neutral skeleton">---------- <span class="change">--------</span></div>
        </div>

        <!-- 英國指數 -->
        <div class="index-card" style="left: 38.1%; top: 28.5%;">
            <div class="card-header">
                <img src="https://flagcdn.com/w40/gb.png" alt="UK Flag" class="flag">
                <div class="date-status">
                    <div class="date">-</div>
                    <div class="status closed">載入中...</div>
                </div>
            </div>
            <div class="index-name">英國指數</div>
            <div class="index-value neutral skeleton">---------- <span class="change">--------</span></div>
        </div>

        <!-- 德國指數 -->
        <div class="index-card" style="left: 54%; top: 40.5%;">
            <div class="card-header">
                <img src="https://flagcdn.com/w40/de.png" alt="Germany Flag" class="flag">
                <div class="date-status">
                    <div class="date">-</div>
                    <div class="status closed">載入中...</div>
                </div>
            </div>
            <div class="index-name">德國指數</div>
            <div class="index-value neutral skeleton">---------- <span class="change">--------</span></div>
        </div>

        <!-- 法國指數 -->
        <div class="index-card" style="left: 38.5%; top: 49.3%;">
            <div class="card-header">
                <img src="https://flagcdn.com/w40/fr.png" alt="France Flag" class="flag">
                <div class="date-status">
                    <div class="date">-</div>
                    <div class="status closed">載入中...</div>
                </div>
            </div>
            <div class="index-name">法國指數</div>
            <div class="index-value neutral skeleton">---------- <span class="change">--------</span></div>
        </div>

        <!-- 南韓綜合 -->
        <div class="index-card" style="left: 66.1%; top: 40.6%;">
            <div class="card-header">
                <img src="https://flagcdn.com/w40/kr.png" alt="South Korea Flag" class="flag">
                <div class="date-status">
                    <div class="date">-</div>
                    <div class="status closed">載入中...</div>
                </div>
            </div>
            <div class="index-name">南韓綜合</div>
            <div class="index-value neutral skeleton">---------- <span class="change">--------</span></div>
        </div>

        <!-- 日本日經 -->
        <div class="index-card" style="left: 81%; top: 46%;">
            <div class="card-header">
                <img src="https://flagcdn.com/w40/jp.png" alt="Japan Flag" class="flag">
                <div class="date-status">
                    <div class="date">-</div>
                    <div class="status closed">載入中...</div>
                </div>
            </div>
            <div class="index-name">日本日經</div>
            <div class="index-value neutral skeleton">---------- <span class="change">--------</span></div>
        </div>

        <!-- 香港恆生 -->
        <div class="index-card" style="left: 63.1%; top: 60.2%;">
            <div class="card-header">
                <img src="https://flagcdn.com/w40/hk.png" alt="Hong Kong Flag" class="flag">
                <div class="date-status">
                    <div class="date">-</div>
                    <div class="status closed">載入中...</div>
                </div>
            </div>
            <div class="index-name">香港恆生</div>
            <div class="index-value neutral skeleton">---------- <span class="change">--------</span></div>
        </div>

        <!-- 加權指數 -->
        <div class="index-card" style="left: 76%; top: 60%;">
            <div class="card-header">
                <img src="https://flagcdn.com/w40/tw.png" alt="Taiwan Flag" class="flag">
                <div class="date-status">
                    <div class="date">-</div>
                    <div class="status closed">載入中...</div>
                </div>
            </div>
            <div class="index-name">加權指數</div>
            <div class="index-value neutral skeleton">---------- <span class="change">--------</span></div>
        </div>
    </div>

    <!-- 浮動國旗調整面板 -->
    <button class="flag-adjuster-toggle" id="flagAdjusterToggle" onclick="toggleFlagAdjuster()">
        <span class="material-symbols-outlined">tune</span>
    </button>

    <div class="flag-adjuster-panel" id="flagAdjusterPanel">
        <div class="flag-adjuster-header" id="flagAdjusterHeader">
            <span class="flag-adjuster-title">
                <span class="material-symbols-outlined">tune</span>
                國旗位置調整
            </span>
            <button class="flag-adjuster-close" onclick="toggleFlagAdjuster()">
                <span class="material-symbols-outlined">close</span>
            </button>
        </div>

        <div class="flag-adjuster-content">
            <!-- 國家選擇 -->
            <div class="adjuster-section">
                <label>選擇國家</label>
                <select id="flagCountrySelect" onchange="selectFlagCountry(this.value)">
                    <optgroup label="股市指數 + ETF">
                        <option value="us">🇺🇸 美國</option>
                        <option value="gb">🇬🇧 英國</option>
                        <option value="de">🇩🇪 德國</option>
                        <option value="fr">🇫🇷 法國</option>
                        <option value="kr">🇰🇷 南韓</option>
                        <option value="jp">🇯🇵 日本</option>
                        <option value="hk">🇭🇰 香港</option>
                        <option value="tw">🇹🇼 台灣</option>
                    </optgroup>
                    <optgroup label="美洲">
                        <option value="ca">🇨🇦 加拿大</option>
                        <option value="br">🇧🇷 巴西</option>
                        <option value="mx">🇲🇽 墨西哥</option>
                        <option value="ar">🇦🇷 阿根廷</option>
                        <option value="co">🇨🇴 哥倫比亞</option>
                    </optgroup>
                    <optgroup label="歐洲">
                        <option value="it">🇮🇹 義大利</option>
                        <option value="es">🇪🇸 西班牙</option>
                        <option value="nl">🇳🇱 荷蘭</option>
                        <option value="ch">🇨🇭 瑞士</option>
                        <option value="pl">🇵🇱 波蘭</option>
                        <option value="be">🇧🇪 比利時</option>
                        <option value="se">🇸🇪 瑞典</option>
                        <option value="ie">🇮🇪 愛爾蘭</option>
                        <option value="at">🇦🇹 奧地利</option>
                        <option value="no">🇳🇴 挪威</option>
                        <option value="dk">🇩🇰 丹麥</option>
                    </optgroup>
                    <optgroup label="亞太">
                        <option value="cn">🇨🇳 中國</option>
                        <option value="in">🇮🇳 印度</option>
                        <option value="id">🇮🇩 印尼</option>
                        <option value="sg">🇸🇬 新加坡</option>
                        <option value="th">🇹🇭 泰國</option>
                        <option value="vn">🇻🇳 越南</option>
                        <option value="ph">🇵🇭 菲律賓</option>
                        <option value="my">🇲🇾 馬來西亞</option>
                        <option value="au">🇦🇺 澳洲</option>
                    </optgroup>
                    <optgroup label="中東/非洲">
                        <option value="tr">🇹🇷 土耳其</option>
                        <option value="sa">🇸🇦 沙烏地</option>
                        <option value="il">🇮🇱 以色列</option>
                        <option value="ae">🇦🇪 阿聯酋</option>
                        <option value="za">🇿🇦 南非</option>
                    </optgroup>
                </select>
            </div>

            <!-- 方向控制 -->
            <div class="adjuster-section">
                <label>位置調整</label>
                <div class="adjuster-direction-pad">
                    <div></div>
                    <button class="adjuster-btn" onclick="moveFlagDirection('up')">
                        <span class="material-symbols-outlined">arrow_upward</span>
                    </button>
                    <div></div>
                    <button class="adjuster-btn" onclick="moveFlagDirection('left')">
                        <span class="material-symbols-outlined">arrow_back</span>
                    </button>
                    <button class="adjuster-btn center" onclick="resetFlagPosition()">
                        <span class="material-symbols-outlined">filter_center_focus</span>
                    </button>
                    <button class="adjuster-btn" onclick="moveFlagDirection('right')">
                        <span class="material-symbols-outlined">arrow_forward</span>
                    </button>
                    <div></div>
                    <button class="adjuster-btn" onclick="moveFlagDirection('down')">
                        <span class="material-symbols-outlined">arrow_downward</span>
                    </button>
                    <div></div>
                </div>
            </div>

            <!-- 座標調整 -->
            <div class="adjuster-section">
                <label>座標 (拖曳地圖國旗或使用滑桿)</label>
                <div class="adjuster-slider-row">
                    <span>經度</span>
                    <input type="range" id="lonSlider" min="-180" max="180" step="0.5" value="0" oninput="adjustFlagBySlider('lon', this.value)">
                    <div class="adjuster-value" id="adjusterLon">0.0</div>
                </div>
                <div class="adjuster-slider-row">
                    <span>緯度</span>
                    <input type="range" id="latSlider" min="-90" max="90" step="0.5" value="0" oninput="adjustFlagBySlider('lat', this.value)">
                    <div class="adjuster-value" id="adjusterLat">0.0</div>
                </div>
            </div>

            <!-- 大小控制 -->
            <div class="adjuster-section">
                <label>大小 (圓形直徑)</label>
                <div class="adjuster-param">
                    <span>縮放</span>
                    <button class="adjuster-btn-sm" onclick="adjustFlagSize(-10)">
                        <span class="material-symbols-outlined">remove</span>
                    </button>
                    <button class="adjuster-btn-sm" onclick="adjustFlagSize(10)">
                        <span class="material-symbols-outlined">add</span>
                    </button>
                </div>
                <div class="adjuster-size-display">
                    直徑: <span id="adjusterSize">120</span> px
                </div>
            </div>

            <!-- 動作按鈕 -->
            <div class="adjuster-actions">
                <button class="adjuster-action-btn primary" onclick="copyFlagConfig()">
                    <span class="material-symbols-outlined">content_copy</span>
                    複製當前
                </button>
                <button class="adjuster-action-btn secondary" onclick="exportAllFlags()">
                    <span class="material-symbols-outlined">download</span>
                    匯出全部
                </button>
            </div>
        </div>
    </div>

    <!-- 提示訊息 -->
    <div class="flag-toast" id="flagToast">已複製！</div>

    <script src="stock-data.js"></script>
    <script src="script.js"></script>
</body>
</html>
